<html>
<head>
	<meta charset="utf-8">
	<title>Phonebook Data Miner</title>
	<script src="currentData.js"></script>
</head>
	<body dir="rtl">
		<script>
		function getPhone(s, i) {
			var m = s.replace(/-/g, '').match(/\d{7,}/g);
			return m && m[i] || '';
		}

		function getMail(s) {
			var m = s.match(/\W([\w.]+@[\w.]+)/);
			return m && m[1] || '';
		}

		function compare(a, b) {
			return a.title.localeCompare(b.title);
		}
		var p = currentData.pages;
		p.sort(compare);
		var counter = 0;
		document.write('<table border=1 dir=rtl>' + p.filter(function(page) {
			return getMail(page.text) || getPhone(page.text, 0);
		}).map(function(page) {
			return '<tr><td>' + (++counter) +
					'</td><td><a href=' + page.url + '>' + page.title + '</a></td><td><a href=mailto:' + getMail(page.text) + '>' + getMail(page.text) + '</a></td><td>' + getPhone(page.text, 0) +
					'</td><td>' + getPhone(page.text, 1) + '</td><td>' + getPhone(page.text, 2) + '</td></tr>';
		}).join('') + '</table>');
		</script>
	</body>
</html>